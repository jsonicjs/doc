!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JsonicDoc=e()}}((function(){var e,t,n,r=e={};function i(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(e){n=l}}();var s,u=[],a=!1,f=-1;function h(){a&&s&&(a=!1,s.length?u=s.concat(u):f=-1,u.length&&c())}function c(){if(!a){var e=o(h);a=!0;for(var t=u.length;t;){for(s=u,u=[];++f<t;)s&&s[f].run();f=-1,t=u.length}s=null,a=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function d(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||a||o(c)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var v={};(function(e){(function(){"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",i=0,l=-1,o=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(l===s-1||1===o);else if(l!==s-1&&2===o){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),l=s,o=0;continue}}else if(2===r.length||1===r.length){r="",i=0,l=s,o=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(l+1,s):r=e.slice(l+1,s),i=s-l-1;l=s,o=0}else 46===n&&-1!==o?++o:o=-1}return r}var r={resolve:function(){for(var r,i="",l=!1,o=arguments.length-1;o>=-1&&!l;o--){var s;o>=0?s=arguments[o]:(void 0===r&&(r=e.cwd()),s=r),t(s),0!==s.length&&(i=s+"/"+i,l=47===s.charCodeAt(0))}return i=n(i,!l),l?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=r.resolve(e))===(n=r.resolve(n)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var l=e.length,o=l-i,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var u=n.length-s,a=o<u?o:u,f=-1,h=0;h<=a;++h){if(h===a){if(u>a){if(47===n.charCodeAt(s+h))return n.slice(s+h+1);if(0===h)return n.slice(s+h)}else o>a&&(47===e.charCodeAt(i+h)?f=h:0===h&&(f=0));break}var c=e.charCodeAt(i+h);if(c!==n.charCodeAt(s+h))break;47===c&&(f=h)}var p="";for(h=i+f+1;h<=l;++h)h!==l&&47!==e.charCodeAt(h)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(s+f):(s+=f,47===n.charCodeAt(s)&&++s,n.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,i=-1,l=!0,o=e.length-1;o>=1;--o)if(47===(n=e.charCodeAt(o))){if(!l){i=o;break}}else l=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,i=0,l=-1,o=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var s=n.length-1,u=-1;for(r=e.length-1;r>=0;--r){var a=e.charCodeAt(r);if(47===a){if(!o){i=r+1;break}}else-1===u&&(o=!1,u=r+1),s>=0&&(a===n.charCodeAt(s)?-1==--s&&(l=r):(s=-1,l=u))}return i===l?l=u:-1===l&&(l=e.length),e.slice(i,l)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!o){i=r+1;break}}else-1===l&&(o=!1,l=r+1);return-1===l?"":e.slice(i,l)},extname:function(e){t(e);for(var n=-1,r=0,i=-1,l=!0,o=0,s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(47!==u)-1===i&&(l=!1,i=s+1),46===u?-1===n?n=s:1!==o&&(o=1):-1!==n&&(o=-1);else if(!l){r=s+1;break}}return-1===n||-1===i||0===o||1===o&&n===i-1&&n===r+1?"":e.slice(n,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,i=e.charCodeAt(0),l=47===i;l?(n.root="/",r=1):r=0;for(var o=-1,s=0,u=-1,a=!0,f=e.length-1,h=0;f>=r;--f)if(47!==(i=e.charCodeAt(f)))-1===u&&(a=!1,u=f+1),46===i?-1===o?o=f:1!==h&&(h=1):-1!==o&&(h=-1);else if(!a){s=f+1;break}return-1===o||-1===u||0===h||1===h&&o===u-1&&o===s+1?-1!==u&&(n.base=n.name=0===s&&l?e.slice(1,u):e.slice(s,u)):(0===s&&l?(n.name=e.slice(1,o),n.base=e.slice(1,u)):(n.name=e.slice(s,o),n.base=e.slice(s,u)),n.ext=e.slice(o,u)),s>0?n.dir=e.slice(0,s-1):l&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,v=r}).call(this)}).call(this,e);var g={exports:{}};(function(e){(function(){!function(t){"object"==typeof g.exports?g.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Gubu=t()}((function(){var e={},t={};Object.defineProperty(t,"__esModule",{value:!0}),t.Gubu=void 0;const n=Symbol.for("gubu$"),r={gubu$:n,v$:"5.0.1"},i=Symbol.for("gubu$nil"),l=/^[A-Z]/,o="",s="name",u="never",a="number",f="required",h="array",c="function",p="object",d="string",v="undefined",g="any",m="list",y="instance",b="null",$="type",w="Object",x="Above",I="Below",k="Some",A="Value",C=" for property ",G='"$PATH"',S='"$VALUE"',V=e=>Object.keys(e),T=(e,t,n)=>Object.defineProperty(e,t,n),N=e=>Array.isArray(e),O=e=>JSON.parse(e),E=(e,t)=>JSON.stringify(e,t);class j{constructor(e,t,n,r){this.match=!1,this.dI=0,this.nI=2,this.cI=-1,this.pI=0,this.sI=-1,this.valType=u,this.isRoot=!1,this.key=o,this.type=u,this.stop=!0,this.nextSibling=!0,this.fromDefault=!1,this.ignoreVal=void 0,this.err=[],this.parents=[],this.keys=[],this.path=[],this.root=e,this.vals=[e,-1],this.node=t,this.nodes=[t,-1],this.ctx=n||{},this.match=!!r}next(){this.stop=!1,this.fromDefault=!1,this.ignoreVal=void 0,this.isRoot=0===this.pI;let e=this.nodes[this.pI];for(;+e;)this.dI--,this.ctx.log&&-1<this.dI&&this.ctx.log("e"+(Array.isArray(this.parents[this.pI])?"a":"o"),this),this.pI=+e,e=this.nodes[this.pI];e?(this.node=e,this.updateVal(this.vals[this.pI]),this.key=this.keys[this.pI],this.cI=this.pI,this.sI=this.pI+1,this.parent=this.parents[this.pI],this.nextSibling=!0,this.type=this.node.t,this.path[this.dI]=this.key,this.oval=this.val):this.stop=!0}updateVal(e){this.val=e,this.valType=typeof this.val,a===this.valType&&isNaN(this.val)&&(this.valType="nan"),this.isRoot&&!this.match&&(this.root=this.val)}printStacks(){var e;console.log("\nNODE","d="+this.dI,"c="+this.cI,"p="+this.pI,"n="+this.nI,+this.node,this.node.t,this.path,this.err.length);for(let t=0;t<this.nodes.length||t<this.vals.length||t<this.parents.length;t++)console.log(t,"\t",isNaN(+this.nodes[t])?this.keys[t]+":"+(null===(e=this.nodes[t])||void 0===e?void 0:e.t):+this.nodes[t],"\t",xe(this.vals[t]),"\t",xe(this.parents[t]))}}class R extends TypeError{constructor(e,t,n){super(t.map(e=>e.t).join("\n")),this.gubu=!0,this.name="GubuError",this.code=e,this.desc=()=>({name:"GubuError",code:e,err:t,ctx:n})}toJSON(){return{...this,err:this.desc().err,name:this.name,message:this.message}}}const D={String:!0,Number:!0,Boolean:!0,Object:!0,Array:!0,Function:!0,Symbol:!0,BigInt:!0},M={string:o,number:0,boolean:!1,object:{},array:[],symbol:Symbol(o),bigint:BigInt(0),null:null};function L(e,t,s){var u,f,m,$;if(_===e)e=void 0;else if(null!=e&&(null===(u=e.$)||void 0===u?void 0:u.gubu$)){if(n===e.$.gubu$)return e.d=null==t?e.d:t,e;if(!0===e.$.gubu$){let r={...e};return r.$={v$:"5.0.1",...r.$,gubu$:n},r.v=null!=r.v&&p===typeof r.v?{...r.v}:r.v,r.t=r.t||typeof r.v,c===r.t&&D[r.v.name]&&(r.t=r.v.name.toLowerCase(),r.v=Ie(M[r.t]),r.f=r.v),r.r=!!r.r,r.p=!!r.p,r.d=null==t?null==r.d?-1:r.d:t,r.b=r.b||[],r.a=r.a||[],r.u=r.u||{},r.m=r.m||s,r}}let x=null===e?b:typeof e;x=v===x?g:x;let I=e,k=I,A=i,C=!1,G={},S=[],T=[];if(p===x)k=void 0,N(I)?(x=h,1===I.length&&(A=I[0],I=[])):null!=I&&Function!==I.constructor&&Object!==I.constructor&&null!=I.constructor?(x=y,G.n=I.constructor.name,G.i=I.constructor,k=I):0===V(I).length&&(A=z());else if(c===x)if(D[e.name])x=e.name.toLowerCase(),C=!0,I=Ie(M[x]),k=I,w===e.name&&(A=z());else if(I.gubu===r||!0===(null===(f=I.$)||void 0===f?void 0:f.gubu)){let e=I.node?I.node():I;x=e.t,I=e.v,k=I,C=e.r,G={...e.u},S=[...e.a],T=[...e.b]}else"Function"===I.constructor.name&&l.test(I.name)&&(x=y,C=!0,G.n=null===($=null===(m=I.prototype)||void 0===m?void 0:m.constructor)||void 0===$?void 0:$.name,G.i=I);else a===x&&isNaN(I)?x="nan":d===x&&o===I&&(G.empty=!0);let O=null==I||p!==x&&h!==x?I:{...I};return{$:r,t:x,v:O,f:k,n:null!=O&&p===typeof O?V(O).length:0,c:A,r:C,p:!1,d:null==t?-1:t,u:G,a:S,b:T,m:s}}function _(t,l){const s=null==l?{}:l;s.name=null==s.name?"G"+(o+Math.random()).substring(2,8):o+s.name;let a=L(t,0);function c(e,t,n){let r=new j(e,a,t,n);for(;r.next(),!r.stop;){let t=r.node,n=!1;if(0<t.b.length)for(let e=0;e<t.b.length;e++){let i=P(t.b[e],r);t=r.node,void 0!==i.done&&(n=i.done)}if(!n){let n=!0,l=void 0===r.val;if(u===r.type)r.err.push($e(u,r,1070));else if(p===r.type){let e;if(t.r&&l?(r.ignoreVal=!0,r.err.push($e(f,r,1010))):l||null!==r.val&&p===r.valType&&!N(r.val)?!t.p&&l&&void 0!==t.f?(r.updateVal(t.f),r.fromDefault=!0,e=r.val,n=!1):t.p&&l||(r.updateVal(r.val||(r.fromDefault=!0,{})),e=r.val):(r.err.push($e($,r,1020)),e=N(r.val)?r.val:{}),n&&(e=null==e&&!1===r.ctx.err?{}:e,null!=e)){r.ctx.log&&r.ctx.log("so",r);let n=!1,l=V(t.v),o=r.nI;if(0<l.length){n=!0,r.pI=o;for(let n=0;n<l.length;n++){let i,o=l[n];if(o.endsWith("$$")){if(i={short:""},"string"==typeof t.v[o]?i.short=t.v[o]:i={...i,...t.v[o]},n++,l.length<=n)break;if(l[n]!==o.substring(0,o.length-2))throw new Error("Invalid meta key: "+o);o=l[n]}let s=t.v[o]=L(t.v[o],1+r.dI,i);r.nodes[r.nI]=s,r.vals[r.nI]=e[o],r.parents[r.nI]=e,r.keys[r.nI]=o,r.nI++}}let s=V(e).filter(e=>void 0===t.v[e]);if(0<s.length)if(i===t.c)r.ignoreVal=!0,r.err.push($e("closed",r,1100,void 0,{k:s}));else{n=!0,r.pI=o;for(let n of s){let i=t.c=L(t.c,1+r.dI);r.nodes[r.nI]=i,r.vals[r.nI]=e[n],r.parents[r.nI]=e,r.keys[r.nI]=n,r.nI++}}n?(r.dI++,r.nodes[r.nI]=r.sI,r.parents[r.nI]=e,r.nextSibling=!1,r.nI++):r.ctx.log&&r.ctx.log("eo",r)}}else if(h===r.type)if(t.r&&l)r.ignoreVal=!0,r.err.push($e(f,r,1030));else if(l||N(r.val)){if(!t.p&&l&&void 0!==t.f)r.updateVal(t.f),r.fromDefault=!0;else if(!t.p||null!=r.val){r.updateVal(r.val||(r.fromDefault=!0,[]));let n=i!==t.c,l=0<r.val.length,s=V(t.v).filter(e=>!isNaN(+e)),u=0<s.length;if(r.ctx.log&&r.ctx.log("sa",r),l||u){r.pI=r.nI;let e=0;if(u)if(s.length<r.val.length&&!n)r.ignoreVal=!0,r.err.push($e("closed",r,1090,void 0,{k:s.length}));else for(;e<s.length;e++){let n=t.v[e]=L(t.v[e],1+r.dI);r.nodes[r.nI]=n,r.vals[r.nI]=r.val[e],r.parents[r.nI]=r.val,r.keys[r.nI]=o+e,r.nI++}if(n&&l){let n=t.c=L(t.c,1+r.dI);for(;e<r.val.length;e++)r.nodes[r.nI]=n,r.vals[r.nI]=r.val[e],r.parents[r.nI]=r.val,r.keys[r.nI]=o+e,r.nI++}r.ignoreVal||(r.dI++,r.nodes[r.nI]=r.sI,r.parents[r.nI]=r.val,r.nextSibling=!1,r.nI++)}else r.ctx.log&&n&&null==e&&r.ctx.log("kv",{...r,key:0,val:t.c}),r.ctx.log&&r.ctx.log("ea",r)}}else r.err.push($e($,r,1040));else if(g===r.type||m===r.type||void 0===r.val||r.type===r.valType||y===r.type&&t.u.i&&r.val instanceof t.u.i||b===r.type&&null===r.val)if(void 0===r.val){let e=r.path[r.dI];!t.r||v===r.type&&r.parent.hasOwnProperty(e)?void 0!==t.f&&!t.p||v===r.type?(r.updateVal(t.f),r.fromDefault=!0):g===r.type&&(r.ignoreVal=void 0===r.ignoreVal||r.ignoreVal):(r.ignoreVal=!0,r.err.push($e(f,r,1060))),r.ctx.log&&r.ctx.log("kv",r)}else d!==r.type||o!==r.val||t.u.empty||r.err.push($e(f,r,1080)),r.ctx.log&&r.ctx.log("kv",r);else r.err.push($e($,r,1050))}if(0<t.a.length)for(let e=0;e<t.a.length;e++){let i=P(t.a[e],r);t=r.node,void 0!==i.done&&(n=i.done)}let l=r.node.p?!1!==r.ignoreVal:!!r.ignoreVal;!r.match&&null!=r.parent&&!n&&!l&&(r.parent[r.key]=r.val),r.nextSibling&&(r.pI=r.sI)}if(0<r.err.length)if(N(r.ctx.err))r.ctx.err.push(...r.err);else if(!r.match&&!1!==r.ctx.err)throw new R("shape",r.err,r.ctx);return r.match?0===r.err.length:r.root}function w(e,t){return c(e,t,!1)}w.valid=function(e,t){let n=t||{};return n.err=n.err||[],c(e,n,!1),0===n.err.length},w.match=(e,t)=>c(e,t=t||{},!0),w.error=(e,t)=>{let n=t||{};return n.err=n.err||[],c(e,n,!1),n.err},w.spec=()=>(w(void 0,{err:!1}),O(xe(a,(e,t)=>n===t||t,!1,!0))),w.node=()=>(w.spec(),a);let x=o;return w.toString=()=>(x=fe(o===x?xe(a&&a.$&&(n===a.$.gubu$||!0===a.$.gubu$)?a.v:a):x),`[Gubu ${s.name} ${x}]`),e.inspect&&e.inspect.custom&&(w[e.inspect.custom]=w.toString),w.gubu=r,w}function P(e,t){var n;let r,i={},l=!1;try{l=!(void 0!==t.val||!(null===(n=e.gubu$)||void 0===n?void 0:n.Check))||e(t.val,i,t)}catch(s){r=s}let u=N(i.err)?0<i.err.length:null!=i.err;if(!l||u){if(void 0===t.val&&(t.node.p||!t.node.r)&&!0!==i.done)return delete i.err,i;let n=i.why||"check",l=B(t);if(d===typeof i.err)t.err.push(be(t,i.err));else if(p===typeof i.err)t.err.push(...[i.err].flat().map(e=>(e.p=null==e.p?l:e.p,e.m=null==e.m?2010:e.m,e)));else{let i=e.name;null!=i&&o!=i||(i=fe(e.toString().replace(/[ \t\r\n]+/g," "))),t.err.push($e(n,t,1045,void 0,{thrown:r},i))}i.done=null==i.done||i.done}return i.hasOwnProperty("uval")?(t.updateVal(i.uval),t.ignoreVal=!1):void 0===i.val||Number.isNaN(i.val)||(t.updateVal(i.val),t.ignoreVal=!1),void 0!==i.node&&(t.node=i.node),void 0!==i.type&&(t.type=i.type),i}function B(e){return e.path.slice(1,e.dI+1).filter(e=>null!=e).join(".")}const q=function(e){let t=ye(this,e);return t.r=!0,t.p=!1,void 0===e&&1===arguments.length&&(t.t=v,t.v=void 0),t},F=function(e){let t=ye(this,e);return t.r=!1,void 0===e&&1===arguments.length&&(t.t=v,t.v=void 0),t},U=function(e){let t=ye(this,e);return t.r=!1,t.p=!0,t},H=function(e){let t=ye(this);return t.t=c,t.v=e,t.f=e,t},J=function(e,t){let n=ye(this,void 0===t?e:t);return n.r=!1,n.f=e,c===typeof e&&D[e.name]&&(n.t=e.name.toLowerCase(),n.f=Ie(M[n.t])),n.p=!1,n},W=function(e){let t=ye(this,e);return t.u.empty=!0,t},z=function(e){let t=ye(this,e);return t.t=g,void 0!==e&&(t.v=e,t.f=e),t},K=function(e){let t=ye(this,e);return t.t=u,t},Z=function(e,t){let n=ye(this),r="number"==typeof e;n.t=d,r&&null==t&&(n=L([]));let i=null;return"function"==typeof e&&(i=e,n=z()),n.b.push((function(n,l,o){if(i)l.val=i(o.path,o);else if(r){let n=e;l.val=o.path.slice(o.path.length-1-(0<=n?n:0),o.path.length-1+(0<=n?0:1)),"string"==typeof t&&(l.val=l.val.join(t))}else null==e&&(l.val=o.path[o.path.length-2]);return!0})),n},Q=function(...e){let t=ye();t.t=m,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let l=!0;for(let e of n){let n={...i.ctx,err:[]};e(t,n),0<n.err.length&&(l=!1)}return l||(r.why="All",r.err=[be(i,A+" "+S+C+G+" does not satisfy all of: "+e.map(e=>xe(e,null,!0)).join(", "))]),l})),t},X=function(...e){let t=ye();t.t=m,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let l=!1;for(let e of n){let n={...i.ctx,err:[]},o=e.match(t,n);o&&(r.val=e(t,n)),l||(l=o)}return l||(r.why=k,r.err=[be(i,A+" "+S+C+G+" does not satisfy any of: "+e.map(e=>xe(e,null,!0)).join(", "))]),l})),t},Y=function(...e){let t=ye();t.t=m,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let l=0;for(let e of n){let n={...i.ctx,err:[]};if(e.match(t,n)){l++,r.val=e(t,n);break}}return 1!==l&&(r.why="One",r.err=[be(i,A+" "+S+C+G+" does not satisfy one of: "+e.map(e=>xe(e,null,!0)).join(", "))]),!0})),t},ee=function(...e){let t=ye();return t.b.push((function(t,n,r){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return n.err=be(r,A+" "+S+C+G+" must be exactly one of: "+r.node.s+"."),n.done=!0,!1})),t.s=e.map(e=>xe(e,null,!0)).join(", "),t},te=function(e,t){let n=ye(this,t);return n.b.push(e),n},ne=function(e,t){let n=ye(this,t);return n.a.push(e),n},re=function(e,t){let n=ye(this,t);if(c===typeof e){let t=e;t.gubu$=t.gubu$||{},t.gubu$.Check=!0,n.b.push(e),n.s=(null==n.s?o:n.s+";")+xe(e,null,!0),n.r=!0}else if(p===typeof e){if(Object.prototype.toString.call(e).includes("RegExp")){let t=t=>null!=t&&!Number.isNaN(t)&&!!String(t).match(e);T(t,s,{value:String(e)}),T(t,"gubu$",{value:{Check:!0}}),n.b.push(t),n.s=xe(e),n.r=!0}}else d===typeof e&&(n.t=e,n.r=!0);return n},ie=function(e){let t=ye(this,e);return t.c=z(),t},le=function(e){let t=ye(this,e);return h===t.t&&i!==t.c&&0===t.n?(t.v=[t.c],t.c=i):t.c=i,t},oe=function(e,t){let n=ye(this,t),r=d===typeof e?e:(p===typeof e&&e||{}).name;return null!=r&&o!=r&&n.b.push((function(e,t,n){return(n.ctx.ref=n.ctx.ref||{})[r]=n.node,!0})),n},se=function(e,t){let n=ye(this,t),r=p===typeof e&&e||{},i=d===typeof e?e:r.name,l=!!r.fill;return null!=i&&o!=i&&n.b.push((function(e,t,n){if(void 0!==e||l){let e=n.ctx.ref=n.ctx.ref||{};if(void 0!==e[i]){let n={...e[i]};n.t=n.t||u,t.node=n,t.type=n.t}}return!0})),n},ue=function(e,t){let n=ye(this,t),r=p===typeof e&&e||{},i=d===typeof e?e:r.name,l="boolean"==typeof r.keep?r.keep:void 0,u=N(r.claim)?r.claim:[];if(null!=i&&o!=i){let e=(e,t,n)=>{if(void 0===e&&0<u.length){n.ctx.Rename=n.ctx.Rename||{},n.ctx.Rename.fromDefault=n.ctx.Rename.fromDefault||{};for(let e of u){let r=n.ctx.Rename.fromDefault[e]||{};if(void 0!==n.parent[e]&&!r.yes){t.val=n.parent[e],n.match||(n.parent[i]=t.val),t.node=r.node;for(let e=0;e<n.err.length;e++)n.err[e].k===r.key&&(n.err.splice(e,1),e--);if(l){let t=n.cI+1;n.nodes.splice(t,0,L(r.dval)),n.vals.splice(t,0,void 0),n.parents.splice(t,0,n.parent),n.keys.splice(t,0,e),n.nI++,n.pI++}else delete n.parent[e];break}}void 0===t.val&&(t.val=n.node.v)}return!0};T(e,s,{value:"Rename:"+i}),n.b.push(e);let t=(e,t,n)=>(n.parent[i]=e,n.match||l||n.key===i||N(n.parent)&&!1!==l||(delete n.parent[n.key],t.done=!0),n.ctx.Rename=n.ctx.Rename||{},n.ctx.Rename.fromDefault=n.ctx.Rename.fromDefault||{},n.ctx.Rename.fromDefault[i]={yes:n.fromDefault,key:n.key,dval:n.node.v,node:n.node},!0);T(t,s,{value:"Rename:"+i}),n.a.push(t)}return n};function ae(e){return a===typeof e?e:a===typeof(null==e?void 0:e.length)?e.length:null!=e&&p===typeof e?V(e).length:NaN}function fe(e,t){let n=String(e),r=null==t||isNaN(t)?30:t<0?0:~~t,i=null==e?0:n.length,l=null==e?o:n.substring(0,i);return l=r<i?l.substring(0,r-3)+"...":l,l.substring(0,r)}const he=function(e,t){let n=ye(this,t);return n.b.push((function(t,n,r){let i=ae(t);if(e<=i)return!0;let l=a===typeof t?o:"length ";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be a minimum ${l}of ${e} (was ${i}).`),!1})),n.s="Min("+e+(null==t?o:","+xe(t))+")",n},ce=function(e,t){let n=ye(this,t);return n.b.push((function(t,n,r){let i=ae(t);if(i<=e)return!0;let l=a===typeof t?o:"length ";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be a maximum ${l}of ${e} (was ${i}).`),!1})),n.s="Max("+e+(null==t?o:","+xe(t))+")",n},pe=function(e,t){let n=ye(this,t);return n.b.push((function(t,n,r){let i=ae(t);if(e<i)return!0;let l=a===typeof t?"be":"have length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must ${l} above ${e} (was ${i}).`),!1})),n.s=x+"("+e+(null==t?o:","+xe(t))+")",n},de=function(e,t){let n=ye(this,t);return n.b.push((function(t,n,r){let i=ae(t);if(i<e)return!0;let l=a===typeof t?"be":"have length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must ${l} below ${e} (was ${i}).`),!1})),n.s=I+"("+e+(null==t?o:","+xe(t))+")",n},ve=function(e,t){let n=ye(this,t||z());return n.b.push((function(t,n,r){let i=ae(t);if(e===i)return!0;let l=a===typeof t?o:" in length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be exactly ${e}${l} (was ${i}).`),!1})),n.s="Len("+e+(null==t?o:","+xe(t))+")",n},ge=function(e,t){let n=ye(null==t?this:t),r=L(e);return n.c=r,n},me=function(e){let t=ye(this,{});return t.c=L(e),t};function ye(e,t){let n=L(null==e||e.window===e||e.global===e?t:e);return Object.assign(n,{Above:pe,After:ne,Any:z,Before:te,Below:de,Check:re,Child:me,Closed:le,Open:ie,Define:oe,Empty:W,Exact:ee,Max:ce,Min:he,Never:K,Len:ve,Refer:se,Rename:ue,Required:q,Skip:U,Value:ge})}function be(e,t,n,r){return $e(n||"check",e,4e3,t,r)}function $e(e,t,n,r,i,l){let s={k:t.key,n:t.node,v:t.val,p:B(t),w:e,m:n,t:o,u:i||{}},a=fe((void 0===t.val?o:xe(t.val)).replace(/"/g,o));if(null==r||o===r){let n=a.startsWith("[")?h:a.startsWith("{")?p:"value",r=a.startsWith("[")||N(t.parents[t.pI])?"index":"property",c="is",d=null==i?void 0:i.k;d=N(d)?(r=1<d.length?(c="are","properties"):r,d.join(", ")):d,s.t="Validation failed for "+(0<s.p.length?`${r} "${s.p}" with `:o)+`${n} "${a}" because `+($===e?y===t.node.t?`the ${n} is not an instance of ${t.node.u.n} `:`the ${n} is not of type ${t.node.t}`:f===e?o===t.val?"an empty string is not allowed":`the ${n} is required`:"closed"===e?`the ${r} "${d}" ${c} not allowed`:u===e?"no value is allowed":`check "${null==l?e:l}" failed`)+(s.u.thrown?" (threw: "+s.u.thrown.message+")":".")}else s.t=r.replace(/\$VALUE/g,a).replace(/\$PATH/g,s.p);return s}function we(e){return null!=e.s&&o!==e.s?e.s:e.r||void 0===e.v?e.t:e.v}function xe(e,t,r,i){let l;i||!e||!e.$||n!==e.$.gubu$&&!0!==e.$.gubu$||(e=we(e));try{l=E(e,(e,r)=>{var l,s;if(t&&(r=t(e,r)),null!=r&&p===typeof r&&r.constructor&&w!==r.constructor.name&&"Array"!==r.constructor.name)r=c===typeof r.toString?r.toString():r.constructor.name;else if(c===typeof r)r=c===typeof _[r.name]&&isNaN(+e)?void 0:null!=r.name&&o!==r.name?r.name:fe(r.toString().replace(/[ \t\r\n]+/g," "));else if("bigint"==typeof r)r=String(r.toString());else{if(Number.isNaN(r))return"NaN";!0===i||!0!==(null===(l=null==r?void 0:r.$)||void 0===l?void 0:l.gubu$)&&n!==(null===(s=null==r?void 0:r.$)||void 0===s?void 0:s.gubu$)||(r=we(r))}return r}),l=String(l)}catch(s){l=E(String(e))}return!0===r&&(l=l.replace(/^"/,o).replace(/"$/,o)),l}function Ie(e){return null==e||p!==typeof e?e:O(E(e))}if(v!==typeof window){let e=[{b:pe,n:x},{b:ne,n:"After"},{b:Q,n:"All"},{b:z,n:"Any"},{b:te,n:"Before"},{b:de,n:I},{b:re,n:"Check"},{b:me,n:"Child"},{b:le,n:"Closed"},{b:oe,n:"Define"},{b:J,n:"Default"},{b:W,n:"Empty"},{b:ee,n:"Exact"},{b:H,n:"Func"},{b:Z,n:"Key"},{b:ce,n:"Max"},{b:he,n:"Min"},{b:K,n:"Never"},{b:ve,n:"Len"},{b:Y,n:"One"},{b:ie,n:"Open"},{b:F,n:"Optional"},{b:se,n:"Refer"},{b:ue,n:"Rename"},{b:q,n:"Required"},{b:U,n:"Skip"},{b:X,n:k},{b:ge,n:A}];for(let t of e)T(t.b,s,{value:t.n})}Object.assign(_,{Gubu:_,Above:pe,After:ne,All:Q,Any:z,Before:te,Below:de,Check:re,Child:me,Closed:le,Define:oe,Default:J,Empty:W,Exact:ee,Func:H,Key:Z,Max:ce,Min:he,Never:K,Len:ve,One:Y,Open:ie,Optional:F,Refer:se,Rename:ue,Required:q,Skip:U,Some:X,Value:ge,GAbove:pe,GAfter:ne,GAll:Q,GAny:z,GBefore:te,GBelow:de,GCheck:re,GChild:me,GClosed:le,GDefine:oe,GDefault:J,GEmpty:W,GExact:ee,GFunc:H,GKey:Z,GMax:ce,GMin:he,GNever:K,GLen:ve,GOne:Y,GOpen:ie,GOptional:F,GRefer:se,GRename:ue,GRequired:q,GSkip:U,GSome:X,GValue:ge,G$:e=>L({...e,$:{gubu$:!0}}),buildize:ye,makeErr:be,stringify:xe,truncate:fe,nodize:L,isShape:e=>e&&r===e.gubu}),T(_,s,{value:"gubu"});const ke=_;t.Gubu=ke;const{Gubu:Ae}=t;return Ae}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),g=g.exports;var m={exports:{}};(function(e){(function(){!function(t){"object"==typeof m.exports?m.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Carn=t()}((function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.Carn=void 0,e.Carn=class{constructor(){this.newline="\n",this.indent="  ",this.separator=",",this.dI=0,this.id=1e6*Math.random()|0,this.s=[]}start(){this.s=[]}add(e){"string"==typeof e&&this.s.push(e)}sep(){this.s.push(new n(this.separator))}depth(e){"number"==typeof e&&(this.dI+=e,this.s.push(new t(this.dI,this.indent)))}src(){let e="";for(let r=0;r<this.s.length;r++){let i=r;this.s[i]instanceof t?(e=this.s[i].toString(),this.s[i]=""):(this.s[i+1]instanceof n&&(this.s[i+2]instanceof t||(this.s[i]+=this.s[i+1].toString()),this.s[i+1]="",r++),this.s[i]=e+this.s[i]+this.newline)}return this.s.join("")+this.newline}inject(e,t,n){let r=this.src();r=r.startsWith("\n")?r:"\n"+r,r=r.endsWith("\n")?r:r+"\n";let i=n[0],l=n[1];const o=new RegExp(i+"START:"+t+l+".*?"+i+"END:"+t+l,"s");return e.replace(o,i+"START:"+t+l+r+i+"END:"+t+l)}};class t{constructor(e,t){this.depth=e,this.indent=t}toString(){return this.indent.repeat(this.depth)}}class n{constructor(e){this.separator=e}toString(){return this.separator}}return e}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),m=m.exports;var y={},b=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(y,"__esModule",{value:!0}),y.MarkerMap=y.GeneratorMap=y.GubuGen=void 0;const $=b({}),w={md:["\x3c!--","--\x3e"]};y.MarkerMap=w;const x={"options~md":function(e,t){var n;t.start(),t.add("## Options");let r=[];e(void 0,{err:!1,log:(e,t)=>{if("kv"===e){let e=t.path.slice(1,t.dI+1),n=e.join("."),i=t.node,l=t.key;r.push({path:n,parts:e,node:i,key:l})}}}),r=r.sort((e,t)=>e.path<t.path?-1:e.path>t.path?1:0);let i=1;for(let l of r){let{path:e,parts:r,node:o,key:s}=l,u=o.t,a=o.r,f=o.v,h=(null===(n=o.m)||void 0===n?void 0:n.short)||s,c=r[r.length-1];for(;i<r.length;)t.add(`* _${r[i-1]}_`),t.depth(1),i++;for(;r.length<i;)t.depth(-1),i--;t.add(`* _${c}_: \`${u}\` ${a?"(required)":"(default: "+f+")"} - ${h}`)}}};y.GeneratorMap=x,y.GubuGen=class{constructor(){}generate(e){let t=function(e,t){let n=e.generator,r=e.format,i=x[n+"~"+r];if(null===i){let t=`Cannot find generator ${e.generator} for format ${e.format}`;throw new Error(t)}return i}(e);const n=new m.Carn;t(e.shape,n);let r=(i=e.target,$.default.readFileSync(i).toString());var i;let l=n.inject(r,e.generator,w[e.format]);return function(e,t){$.default.writeFileSync(e,t)}(e.target,l),n}};var I={},k=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(I,"__esModule",{value:!0}),I.JsonicDoc=void 0;const A=k(v);class C{constructor(e,t){this.spec=e;try{const e=require(this.spec.folder);this.plugin=e[this.spec.name],null==this.plugin&&(this.plugin=e[this.spec.name[0].toUpperCase()+this.spec.name.substring(1)]),null==this.plugin&&t.errs.push("No plugin found for name: "+this.spec.name+" in package at: "+this.spec.folder)}catch(n){t.errs.push(n.message)}}genOptionsMD(){const e=this.plugin.defaults,t=(0,g.Gubu)(e),n=A.default.join(this.spec.folder,"README.md");(new y.GubuGen).generate({shape:t,generator:"options",format:"md",target:n})}}return I.JsonicDoc=C,C.defaults={folder:"",name:""},I}));