!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JsonicDoc=e()}}((function(){var e,t,n,r=e={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,a=[],u=!1,h=-1;function f(){u&&s&&(u=!1,s.length?a=s.concat(a):h=-1,a.length&&c())}function c(){if(!u){var e=l(f);u=!0;for(var t=a.length;t;){for(s=a,a=[];++h<t;)s&&s[h].run();h=-1,t=a.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function d(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new p(e,t)),1!==a.length||u||l(c)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var v={};(function(e){(function(){"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",i=0,o=-1,l=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(o===s-1||1===l);else if(o!==s-1&&2===l){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var a=r.lastIndexOf("/");if(a!==r.length-1){-1===a?(r="",i=0):i=(r=r.slice(0,a)).length-1-r.lastIndexOf("/"),o=s,l=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=s,l=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,s):r=e.slice(o+1,s),i=s-o-1;o=s,l=0}else 46===n&&-1!==l?++l:l=-1}return r}var r={resolve:function(){for(var r,i="",o=!1,l=arguments.length-1;l>=-1&&!o;l--){var s;l>=0?s=arguments[l]:(void 0===r&&(r=e.cwd()),s=r),t(s),0!==s.length&&(i=s+"/"+i,o=47===s.charCodeAt(0))}return i=n(i,!o),o?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=r.resolve(e))===(n=r.resolve(n)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var o=e.length,l=o-i,s=1;s<n.length&&47===n.charCodeAt(s);++s);for(var a=n.length-s,u=l<a?l:a,h=-1,f=0;f<=u;++f){if(f===u){if(a>u){if(47===n.charCodeAt(s+f))return n.slice(s+f+1);if(0===f)return n.slice(s+f)}else l>u&&(47===e.charCodeAt(i+f)?h=f:0===f&&(h=0));break}var c=e.charCodeAt(i+f);if(c!==n.charCodeAt(s+f))break;47===c&&(h=f)}var p="";for(f=i+h+1;f<=o;++f)f!==o&&47!==e.charCodeAt(f)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(s+h):(s+=h,47===n.charCodeAt(s)&&++s,n.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,i=-1,o=!0,l=e.length-1;l>=1;--l)if(47===(n=e.charCodeAt(l))){if(!o){i=l;break}}else o=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,i=0,o=-1,l=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var s=n.length-1,a=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!l){i=r+1;break}}else-1===a&&(l=!1,a=r+1),s>=0&&(u===n.charCodeAt(s)?-1==--s&&(o=r):(s=-1,o=a))}return i===o?o=a:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!l){i=r+1;break}}else-1===o&&(l=!1,o=r+1);return-1===o?"":e.slice(i,o)},extname:function(e){t(e);for(var n=-1,r=0,i=-1,o=!0,l=0,s=e.length-1;s>=0;--s){var a=e.charCodeAt(s);if(47!==a)-1===i&&(o=!1,i=s+1),46===a?-1===n?n=s:1!==l&&(l=1):-1!==n&&(l=-1);else if(!o){r=s+1;break}}return-1===n||-1===i||0===l||1===l&&n===i-1&&n===r+1?"":e.slice(n,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,i=e.charCodeAt(0),o=47===i;o?(n.root="/",r=1):r=0;for(var l=-1,s=0,a=-1,u=!0,h=e.length-1,f=0;h>=r;--h)if(47!==(i=e.charCodeAt(h)))-1===a&&(u=!1,a=h+1),46===i?-1===l?l=h:1!==f&&(f=1):-1!==l&&(f=-1);else if(!u){s=h+1;break}return-1===l||-1===a||0===f||1===f&&l===a-1&&l===s+1?-1!==a&&(n.base=n.name=0===s&&o?e.slice(1,a):e.slice(s,a)):(0===s&&o?(n.name=e.slice(1,l),n.base=e.slice(1,a)):(n.name=e.slice(s,l),n.base=e.slice(s,a)),n.ext=e.slice(l,a)),s>0?n.dir=e.slice(0,s-1):o&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,v=r}).call(this)}).call(this,e);var g={exports:{}};(function(e){(function(){!function(t){"object"==typeof g.exports?g.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Gubu=t()}((function(){var e={},t={};Object.defineProperty(t,"__esModule",{value:!0}),t.Gubu=void 0;const n=Symbol.for("gubu$"),r={gubu$:n,v$:"5.0.1"},i=Symbol.for("gubu$nil"),o=/^[A-Z]/,l="",s="name",a="never",u="number",h="required",f="array",c="function",p="object",d="string",v="undefined",g="any",y="list",m="instance",b="null",x="type",w="Object",$="Above",I="Below",k="Some",A="Value",C=" for property ",G='"$PATH"',S='"$VALUE"',V=e=>Object.keys(e),N=(e,t,n)=>Object.defineProperty(e,t,n),T=e=>Array.isArray(e),O=e=>JSON.parse(e),E=(e,t)=>JSON.stringify(e,t);class j{constructor(e,t,n,r){this.match=!1,this.dI=0,this.nI=2,this.cI=-1,this.pI=0,this.sI=-1,this.valType=a,this.isRoot=!1,this.key=l,this.type=a,this.stop=!0,this.nextSibling=!0,this.fromDefault=!1,this.ignoreVal=void 0,this.err=[],this.parents=[],this.keys=[],this.path=[],this.root=e,this.vals=[e,-1],this.node=t,this.nodes=[t,-1],this.ctx=n||{},this.match=!!r}next(){this.stop=!1,this.fromDefault=!1,this.ignoreVal=void 0,this.isRoot=0===this.pI;let e=this.nodes[this.pI];for(;+e;)this.dI--,this.ctx.log&&-1<this.dI&&this.ctx.log("e"+(Array.isArray(this.parents[this.pI])?"a":"o"),this),this.pI=+e,e=this.nodes[this.pI];e?(this.node=e,this.updateVal(this.vals[this.pI]),this.key=this.keys[this.pI],this.cI=this.pI,this.sI=this.pI+1,this.parent=this.parents[this.pI],this.nextSibling=!0,this.type=this.node.t,this.path[this.dI]=this.key,this.oval=this.val):this.stop=!0}updateVal(e){this.val=e,this.valType=typeof this.val,u===this.valType&&isNaN(this.val)&&(this.valType="nan"),this.isRoot&&!this.match&&(this.root=this.val)}printStacks(){var e;console.log("\nNODE","d="+this.dI,"c="+this.cI,"p="+this.pI,"n="+this.nI,+this.node,this.node.t,this.path,this.err.length);for(let t=0;t<this.nodes.length||t<this.vals.length||t<this.parents.length;t++)console.log(t,"\t",isNaN(+this.nodes[t])?this.keys[t]+":"+(null===(e=this.nodes[t])||void 0===e?void 0:e.t):+this.nodes[t],"\t",$e(this.vals[t]),"\t",$e(this.parents[t]))}}class R extends TypeError{constructor(e,t,n){super(t.map(e=>e.t).join("\n")),this.gubu=!0,this.name="GubuError",this.code=e,this.desc=()=>({name:"GubuError",code:e,err:t,ctx:n})}toJSON(){return{...this,err:this.desc().err,name:this.name,message:this.message}}}const D={String:!0,Number:!0,Boolean:!0,Object:!0,Array:!0,Function:!0,Symbol:!0,BigInt:!0},_={string:l,number:0,boolean:!1,object:{},array:[],symbol:Symbol(l),bigint:BigInt(0),null:null};function M(e,t,s){var a,h,y,x;if(L===e)e=void 0;else if(null!=e&&(null===(a=e.$)||void 0===a?void 0:a.gubu$)){if(n===e.$.gubu$)return e.d=null==t?e.d:t,e;if(!0===e.$.gubu$){let r={...e};return r.$={v$:"5.0.1",...r.$,gubu$:n},r.v=null!=r.v&&p===typeof r.v?{...r.v}:r.v,r.t=r.t||typeof r.v,c===r.t&&D[r.v.name]&&(r.t=r.v.name.toLowerCase(),r.v=Ie(_[r.t]),r.f=r.v),r.r=!!r.r,r.p=!!r.p,r.d=null==t?null==r.d?-1:r.d:t,r.b=r.b||[],r.a=r.a||[],r.u=r.u||{},r.m=r.m||s,r}}let $=null===e?b:typeof e;$=v===$?g:$;let I=e,k=I,A=i,C=!1,G={},S=[],N=[];if(p===$)k=void 0,T(I)?($=f,1===I.length&&(A=I[0],I=[])):null!=I&&Function!==I.constructor&&Object!==I.constructor&&null!=I.constructor?($=m,G.n=I.constructor.name,G.i=I.constructor,k=I):0===V(I).length&&(A=z());else if(c===$)if(D[e.name])$=e.name.toLowerCase(),C=!0,I=Ie(_[$]),k=I,w===e.name&&(A=z());else if(I.gubu===r||!0===(null===(h=I.$)||void 0===h?void 0:h.gubu)){let e=I.node?I.node():I;$=e.t,I=e.v,k=I,C=e.r,G={...e.u},S=[...e.a],N=[...e.b]}else"Function"===I.constructor.name&&o.test(I.name)&&($=m,C=!0,G.n=null===(x=null===(y=I.prototype)||void 0===y?void 0:y.constructor)||void 0===x?void 0:x.name,G.i=I);else u===$&&isNaN(I)?$="nan":d===$&&l===I&&(G.empty=!0);let O=null==I||p!==$&&f!==$?I:{...I};return{$:r,t:$,v:O,f:k,n:null!=O&&p===typeof O?V(O).length:0,c:A,r:C,p:!1,d:null==t?-1:t,u:G,a:S,b:N,m:s}}function L(t,o){const s=null==o?{}:o;s.name=null==s.name?"G"+(l+Math.random()).substring(2,8):l+s.name;let u=M(t,0);function c(e,t,n){let r=new j(e,u,t,n);for(;r.next(),!r.stop;){let t=r.node,n=!1;if(0<t.b.length)for(let e=0;e<t.b.length;e++){let i=P(t.b[e],r);t=r.node,void 0!==i.done&&(n=i.done)}if(!n){let n=!0,o=void 0===r.val;if(a===r.type)r.err.push(xe(a,r,1070));else if(p===r.type){let e;if(t.r&&o?(r.ignoreVal=!0,r.err.push(xe(h,r,1010))):o||null!==r.val&&p===r.valType&&!T(r.val)?!t.p&&o&&void 0!==t.f?(r.updateVal(t.f),r.fromDefault=!0,e=r.val,n=!1):t.p&&o||(r.updateVal(r.val||(r.fromDefault=!0,{})),e=r.val):(r.err.push(xe(x,r,1020)),e=T(r.val)?r.val:{}),n&&(e=null==e&&!1===r.ctx.err?{}:e,null!=e)){r.ctx.log&&r.ctx.log("so",r);let n=!1,o=V(t.v),l=r.nI;if(0<o.length){n=!0,r.pI=l;for(let n=0;n<o.length;n++){let i,l=o[n];if(l.endsWith("$$")){if(i={short:""},"string"==typeof t.v[l]?i.short=t.v[l]:i={...i,...t.v[l]},n++,o.length<=n)break;if(o[n]!==l.substring(0,l.length-2))throw new Error("Invalid meta key: "+l);l=o[n]}let s=t.v[l]=M(t.v[l],1+r.dI,i);r.nodes[r.nI]=s,r.vals[r.nI]=e[l],r.parents[r.nI]=e,r.keys[r.nI]=l,r.nI++}}let s=V(e).filter(e=>void 0===t.v[e]);if(0<s.length)if(i===t.c)r.ignoreVal=!0,r.err.push(xe("closed",r,1100,void 0,{k:s}));else{n=!0,r.pI=l;for(let n of s){let i=t.c=M(t.c,1+r.dI);r.nodes[r.nI]=i,r.vals[r.nI]=e[n],r.parents[r.nI]=e,r.keys[r.nI]=n,r.nI++}}n?(r.dI++,r.nodes[r.nI]=r.sI,r.parents[r.nI]=e,r.nextSibling=!1,r.nI++):r.ctx.log&&r.ctx.log("eo",r)}}else if(f===r.type)if(t.r&&o)r.ignoreVal=!0,r.err.push(xe(h,r,1030));else if(o||T(r.val)){if(!t.p&&o&&void 0!==t.f)r.updateVal(t.f),r.fromDefault=!0;else if(!t.p||null!=r.val){r.updateVal(r.val||(r.fromDefault=!0,[]));let n=i!==t.c,o=0<r.val.length,s=V(t.v).filter(e=>!isNaN(+e)),a=0<s.length;if(r.ctx.log&&r.ctx.log("sa",r),o||a){r.pI=r.nI;let e=0;if(a)if(s.length<r.val.length&&!n)r.ignoreVal=!0,r.err.push(xe("closed",r,1090,void 0,{k:s.length}));else for(;e<s.length;e++){let n=t.v[e]=M(t.v[e],1+r.dI);r.nodes[r.nI]=n,r.vals[r.nI]=r.val[e],r.parents[r.nI]=r.val,r.keys[r.nI]=l+e,r.nI++}if(n&&o){let n=t.c=M(t.c,1+r.dI);for(;e<r.val.length;e++)r.nodes[r.nI]=n,r.vals[r.nI]=r.val[e],r.parents[r.nI]=r.val,r.keys[r.nI]=l+e,r.nI++}r.ignoreVal||(r.dI++,r.nodes[r.nI]=r.sI,r.parents[r.nI]=r.val,r.nextSibling=!1,r.nI++)}else r.ctx.log&&n&&null==e&&r.ctx.log("kv",{...r,key:0,val:t.c}),r.ctx.log&&r.ctx.log("ea",r)}}else r.err.push(xe(x,r,1040));else if(g===r.type||y===r.type||void 0===r.val||r.type===r.valType||m===r.type&&t.u.i&&r.val instanceof t.u.i||b===r.type&&null===r.val)if(void 0===r.val){let e=r.path[r.dI];!t.r||v===r.type&&r.parent.hasOwnProperty(e)?void 0!==t.f&&!t.p||v===r.type?(r.updateVal(t.f),r.fromDefault=!0):g===r.type&&(r.ignoreVal=void 0===r.ignoreVal||r.ignoreVal):(r.ignoreVal=!0,r.err.push(xe(h,r,1060))),r.ctx.log&&r.ctx.log("kv",r)}else d!==r.type||l!==r.val||t.u.empty||r.err.push(xe(h,r,1080)),r.ctx.log&&r.ctx.log("kv",r);else r.err.push(xe(x,r,1050))}if(0<t.a.length)for(let e=0;e<t.a.length;e++){let i=P(t.a[e],r);t=r.node,void 0!==i.done&&(n=i.done)}let o=r.node.p?!1!==r.ignoreVal:!!r.ignoreVal;!r.match&&null!=r.parent&&!n&&!o&&(r.parent[r.key]=r.val),r.nextSibling&&(r.pI=r.sI)}if(0<r.err.length)if(T(r.ctx.err))r.ctx.err.push(...r.err);else if(!r.match&&!1!==r.ctx.err)throw new R("shape",r.err,r.ctx);return r.match?0===r.err.length:r.root}function w(e,t){return c(e,t,!1)}w.valid=function(e,t){let n=t||{};return n.err=n.err||[],c(e,n,!1),0===n.err.length},w.match=(e,t)=>c(e,t=t||{},!0),w.error=(e,t)=>{let n=t||{};return n.err=n.err||[],c(e,n,!1),n.err},w.spec=()=>(w(void 0,{err:!1}),O($e(u,(e,t)=>n===t||t,!1,!0))),w.node=()=>(w.spec(),u);let $=l;return w.toString=()=>($=he(l===$?$e(u&&u.$&&(n===u.$.gubu$||!0===u.$.gubu$)?u.v:u):$),`[Gubu ${s.name} ${$}]`),e.inspect&&e.inspect.custom&&(w[e.inspect.custom]=w.toString),w.gubu=r,w}function P(e,t){var n;let r,i={},o=!1;try{o=!(void 0!==t.val||!(null===(n=e.gubu$)||void 0===n?void 0:n.Check))||e(t.val,i,t)}catch(s){r=s}let a=T(i.err)?0<i.err.length:null!=i.err;if(!o||a){if(void 0===t.val&&(t.node.p||!t.node.r)&&!0!==i.done)return delete i.err,i;let n=i.why||"check",o=B(t);if(d===typeof i.err)t.err.push(be(t,i.err));else if(p===typeof i.err)t.err.push(...[i.err].flat().map(e=>(e.p=null==e.p?o:e.p,e.m=null==e.m?2010:e.m,e)));else{let i=e.name;null!=i&&l!=i||(i=he(e.toString().replace(/[ \t\r\n]+/g," "))),t.err.push(xe(n,t,1045,void 0,{thrown:r},i))}i.done=null==i.done||i.done}return i.hasOwnProperty("uval")?(t.updateVal(i.uval),t.ignoreVal=!1):void 0===i.val||Number.isNaN(i.val)||(t.updateVal(i.val),t.ignoreVal=!1),void 0!==i.node&&(t.node=i.node),void 0!==i.type&&(t.type=i.type),i}function B(e){return e.path.slice(1,e.dI+1).filter(e=>null!=e).join(".")}const q=function(e){let t=me(this,e);return t.r=!0,t.p=!1,void 0===e&&1===arguments.length&&(t.t=v,t.v=void 0),t},F=function(e){let t=me(this,e);return t.r=!1,void 0===e&&1===arguments.length&&(t.t=v,t.v=void 0),t},U=function(e){let t=me(this,e);return t.r=!1,t.p=!0,t},H=function(e){let t=me(this);return t.t=c,t.v=e,t.f=e,t},J=function(e,t){let n=me(this,void 0===t?e:t);return n.r=!1,n.f=e,c===typeof e&&D[e.name]&&(n.t=e.name.toLowerCase(),n.f=Ie(_[n.t])),n.p=!1,n},W=function(e){let t=me(this,e);return t.u.empty=!0,t},z=function(e){let t=me(this,e);return t.t=g,void 0!==e&&(t.v=e,t.f=e),t},K=function(e){let t=me(this,e);return t.t=a,t},Z=function(e,t){let n=me(this),r="number"==typeof e;n.t=d,r&&null==t&&(n=M([]));let i=null;return"function"==typeof e&&(i=e,n=z()),n.b.push((function(n,o,l){if(i)o.val=i(l.path,l);else if(r){let n=e;o.val=l.path.slice(l.path.length-1-(0<=n?n:0),l.path.length-1+(0<=n?0:1)),"string"==typeof t&&(o.val=o.val.join(t))}else null==e&&(o.val=l.path[l.path.length-2]);return!0})),n},Q=function(...e){let t=me();t.t=y,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let o=!0;for(let e of n){let n={...i.ctx,err:[]};e(t,n),0<n.err.length&&(o=!1)}return o||(r.why="All",r.err=[be(i,A+" "+S+C+G+" does not satisfy all of: "+e.map(e=>$e(e,null,!0)).join(", "))]),o})),t},X=function(...e){let t=me();t.t=y,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let o=!1;for(let e of n){let n={...i.ctx,err:[]},l=e.match(t,n);l&&(r.val=e(t,n)),o||(o=l)}return o||(r.why=k,r.err=[be(i,A+" "+S+C+G+" does not satisfy any of: "+e.map(e=>$e(e,null,!0)).join(", "))]),o})),t},Y=function(...e){let t=me();t.t=y,t.r=!0;let n=e.map(e=>ke(e));return t.u.list=e,t.b.push((function(t,r,i){let o=0;for(let e of n){let n={...i.ctx,err:[]};if(e.match(t,n)){o++,r.val=e(t,n);break}}return 1!==o&&(r.why="One",r.err=[be(i,A+" "+S+C+G+" does not satisfy one of: "+e.map(e=>$e(e,null,!0)).join(", "))]),!0})),t},ee=function(...e){let t=me();return t.b.push((function(t,n,r){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return n.err=be(r,A+" "+S+C+G+" must be exactly one of: "+r.node.s+"."),n.done=!0,!1})),t.s=e.map(e=>$e(e,null,!0)).join(", "),t},te=function(e,t){let n=me(this,t);return n.b.push(e),n},ne=function(e,t){let n=me(this,t);return n.a.push(e),n},re=function(e,t){let n=me(this,t);if(c===typeof e){let t=e;t.gubu$=t.gubu$||{},t.gubu$.Check=!0,n.b.push(e),n.s=(null==n.s?l:n.s+";")+$e(e,null,!0),n.r=!0}else if(p===typeof e){if(Object.prototype.toString.call(e).includes("RegExp")){let t=t=>null!=t&&!Number.isNaN(t)&&!!String(t).match(e);N(t,s,{value:String(e)}),N(t,"gubu$",{value:{Check:!0}}),n.b.push(t),n.s=$e(e),n.r=!0}}else d===typeof e&&(n.t=e,n.r=!0);return n},ie=function(e){let t=me(this,e);return t.c=z(),t},oe=function(e){let t=me(this,e);return f===t.t&&i!==t.c&&0===t.n?(t.v=[t.c],t.c=i):t.c=i,t},le=function(e,t){let n=me(this,t),r=d===typeof e?e:(p===typeof e&&e||{}).name;return null!=r&&l!=r&&n.b.push((function(e,t,n){return(n.ctx.ref=n.ctx.ref||{})[r]=n.node,!0})),n},se=function(e,t){let n=me(this,t),r=p===typeof e&&e||{},i=d===typeof e?e:r.name,o=!!r.fill;return null!=i&&l!=i&&n.b.push((function(e,t,n){if(void 0!==e||o){let e=n.ctx.ref=n.ctx.ref||{};if(void 0!==e[i]){let n={...e[i]};n.t=n.t||a,t.node=n,t.type=n.t}}return!0})),n},ae=function(e,t){let n=me(this,t),r=p===typeof e&&e||{},i=d===typeof e?e:r.name,o="boolean"==typeof r.keep?r.keep:void 0,a=T(r.claim)?r.claim:[];if(null!=i&&l!=i){let e=(e,t,n)=>{if(void 0===e&&0<a.length){n.ctx.Rename=n.ctx.Rename||{},n.ctx.Rename.fromDefault=n.ctx.Rename.fromDefault||{};for(let e of a){let r=n.ctx.Rename.fromDefault[e]||{};if(void 0!==n.parent[e]&&!r.yes){t.val=n.parent[e],n.match||(n.parent[i]=t.val),t.node=r.node;for(let e=0;e<n.err.length;e++)n.err[e].k===r.key&&(n.err.splice(e,1),e--);if(o){let t=n.cI+1;n.nodes.splice(t,0,M(r.dval)),n.vals.splice(t,0,void 0),n.parents.splice(t,0,n.parent),n.keys.splice(t,0,e),n.nI++,n.pI++}else delete n.parent[e];break}}void 0===t.val&&(t.val=n.node.v)}return!0};N(e,s,{value:"Rename:"+i}),n.b.push(e);let t=(e,t,n)=>(n.parent[i]=e,n.match||o||n.key===i||T(n.parent)&&!1!==o||(delete n.parent[n.key],t.done=!0),n.ctx.Rename=n.ctx.Rename||{},n.ctx.Rename.fromDefault=n.ctx.Rename.fromDefault||{},n.ctx.Rename.fromDefault[i]={yes:n.fromDefault,key:n.key,dval:n.node.v,node:n.node},!0);N(t,s,{value:"Rename:"+i}),n.a.push(t)}return n};function ue(e){return u===typeof e?e:u===typeof(null==e?void 0:e.length)?e.length:null!=e&&p===typeof e?V(e).length:NaN}function he(e,t){let n=String(e),r=null==t||isNaN(t)?30:t<0?0:~~t,i=null==e?0:n.length,o=null==e?l:n.substring(0,i);return o=r<i?o.substring(0,r-3)+"...":o,o.substring(0,r)}const fe=function(e,t){let n=me(this,t);return n.b.push((function(t,n,r){let i=ue(t);if(e<=i)return!0;let o=u===typeof t?l:"length ";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be a minimum ${o}of ${e} (was ${i}).`),!1})),n.s="Min("+e+(null==t?l:","+$e(t))+")",n},ce=function(e,t){let n=me(this,t);return n.b.push((function(t,n,r){let i=ue(t);if(i<=e)return!0;let o=u===typeof t?l:"length ";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be a maximum ${o}of ${e} (was ${i}).`),!1})),n.s="Max("+e+(null==t?l:","+$e(t))+")",n},pe=function(e,t){let n=me(this,t);return n.b.push((function(t,n,r){let i=ue(t);if(e<i)return!0;let o=u===typeof t?"be":"have length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must ${o} above ${e} (was ${i}).`),!1})),n.s=$+"("+e+(null==t?l:","+$e(t))+")",n},de=function(e,t){let n=me(this,t);return n.b.push((function(t,n,r){let i=ue(t);if(i<e)return!0;let o=u===typeof t?"be":"have length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must ${o} below ${e} (was ${i}).`),!1})),n.s=I+"("+e+(null==t?l:","+$e(t))+")",n},ve=function(e,t){let n=me(this,t||z());return n.b.push((function(t,n,r){let i=ue(t);if(e===i)return!0;let o=u===typeof t?l:" in length";return n.err=be(r,`Value "$VALUE" for property "$PATH" must be exactly ${e}${o} (was ${i}).`),!1})),n.s="Len("+e+(null==t?l:","+$e(t))+")",n},ge=function(e,t){let n=me(null==t?this:t),r=M(e);return n.c=r,n},ye=function(e){let t=me(this,{});return t.c=M(e),t};function me(e,t){let n=M(null==e||e.window===e||e.global===e?t:e);return Object.assign(n,{Above:pe,After:ne,Any:z,Before:te,Below:de,Check:re,Child:ye,Closed:oe,Open:ie,Define:le,Empty:W,Exact:ee,Max:ce,Min:fe,Never:K,Len:ve,Refer:se,Rename:ae,Required:q,Skip:U,Value:ge})}function be(e,t,n,r){return xe(n||"check",e,4e3,t,r)}function xe(e,t,n,r,i,o){let s={k:t.key,n:t.node,v:t.val,p:B(t),w:e,m:n,t:l,u:i||{}},u=he((void 0===t.val?l:$e(t.val)).replace(/"/g,l));if(null==r||l===r){let n=u.startsWith("[")?f:u.startsWith("{")?p:"value",r=u.startsWith("[")||T(t.parents[t.pI])?"index":"property",c="is",d=null==i?void 0:i.k;d=T(d)?(r=1<d.length?(c="are","properties"):r,d.join(", ")):d,s.t="Validation failed for "+(0<s.p.length?`${r} "${s.p}" with `:l)+`${n} "${u}" because `+(x===e?m===t.node.t?`the ${n} is not an instance of ${t.node.u.n} `:`the ${n} is not of type ${t.node.t}`:h===e?l===t.val?"an empty string is not allowed":`the ${n} is required`:"closed"===e?`the ${r} "${d}" ${c} not allowed`:a===e?"no value is allowed":`check "${null==o?e:o}" failed`)+(s.u.thrown?" (threw: "+s.u.thrown.message+")":".")}else s.t=r.replace(/\$VALUE/g,u).replace(/\$PATH/g,s.p);return s}function we(e){return null!=e.s&&l!==e.s?e.s:e.r||void 0===e.v?e.t:e.v}function $e(e,t,r,i){let o;i||!e||!e.$||n!==e.$.gubu$&&!0!==e.$.gubu$||(e=we(e));try{o=E(e,(e,r)=>{var o,s;if(t&&(r=t(e,r)),null!=r&&p===typeof r&&r.constructor&&w!==r.constructor.name&&"Array"!==r.constructor.name)r=c===typeof r.toString?r.toString():r.constructor.name;else if(c===typeof r)r=c===typeof L[r.name]&&isNaN(+e)?void 0:null!=r.name&&l!==r.name?r.name:he(r.toString().replace(/[ \t\r\n]+/g," "));else if("bigint"==typeof r)r=String(r.toString());else{if(Number.isNaN(r))return"NaN";!0===i||!0!==(null===(o=null==r?void 0:r.$)||void 0===o?void 0:o.gubu$)&&n!==(null===(s=null==r?void 0:r.$)||void 0===s?void 0:s.gubu$)||(r=we(r))}return r}),o=String(o)}catch(s){o=E(String(e))}return!0===r&&(o=o.replace(/^"/,l).replace(/"$/,l)),o}function Ie(e){return null==e||p!==typeof e?e:O(E(e))}if(v!==typeof window){let e=[{b:pe,n:$},{b:ne,n:"After"},{b:Q,n:"All"},{b:z,n:"Any"},{b:te,n:"Before"},{b:de,n:I},{b:re,n:"Check"},{b:ye,n:"Child"},{b:oe,n:"Closed"},{b:le,n:"Define"},{b:J,n:"Default"},{b:W,n:"Empty"},{b:ee,n:"Exact"},{b:H,n:"Func"},{b:Z,n:"Key"},{b:ce,n:"Max"},{b:fe,n:"Min"},{b:K,n:"Never"},{b:ve,n:"Len"},{b:Y,n:"One"},{b:ie,n:"Open"},{b:F,n:"Optional"},{b:se,n:"Refer"},{b:ae,n:"Rename"},{b:q,n:"Required"},{b:U,n:"Skip"},{b:X,n:k},{b:ge,n:A}];for(let t of e)N(t.b,s,{value:t.n})}Object.assign(L,{Gubu:L,Above:pe,After:ne,All:Q,Any:z,Before:te,Below:de,Check:re,Child:ye,Closed:oe,Define:le,Default:J,Empty:W,Exact:ee,Func:H,Key:Z,Max:ce,Min:fe,Never:K,Len:ve,One:Y,Open:ie,Optional:F,Refer:se,Rename:ae,Required:q,Skip:U,Some:X,Value:ge,GAbove:pe,GAfter:ne,GAll:Q,GAny:z,GBefore:te,GBelow:de,GCheck:re,GChild:ye,GClosed:oe,GDefine:le,GDefault:J,GEmpty:W,GExact:ee,GFunc:H,GKey:Z,GMax:ce,GMin:fe,GNever:K,GLen:ve,GOne:Y,GOpen:ie,GOptional:F,GRefer:se,GRename:ae,GRequired:q,GSkip:U,GSome:X,GValue:ge,G$:e=>M({...e,$:{gubu$:!0}}),buildize:me,makeErr:be,stringify:$e,truncate:he,nodize:M,isShape:e=>e&&r===e.gubu}),N(L,s,{value:"gubu"});const ke=L;t.Gubu=ke;const{Gubu:Ae}=t;return Ae}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),g=g.exports;var y={exports:{}};(function(e){(function(){!function(t){"object"==typeof y.exports?y.exports=t():("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:this).Carn=t()}((function(){var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.Carn=void 0;class t{constructor(e){this.start=-1,this.finish=-1,this.errs=[],this.bail=!0,this.id=e,this.run=-1}error(e,t,...r){let i=new n(this.id,this.run,e,t,...r);if(this.errs.push(i),this.bail)throw i;return i}throw(e,t,...n){throw this.error(e,t,...n)}init(e){this.run=e,this.start=Date.now(),this.bail=!1}check(){return this.active()||this.throw("not_active")}active(){return 0<this.start&&this.finish<0}finished(){return 0<this.finish}}class n extends Error{constructor(e,t,r,i,...o){(o="string"==typeof i?[i,...o]:o&&"string"==typeof o[0]?o:[n.Code[r]||r,...o])[0]+=` [id=${e},run=${t}]`+(i?" {"+Object.keys(i).map(e=>e+":"+i[e])+"}":""),super(...o),this.code=r,this.cid=e,this.crun=t}}n.Code={not_active:"Carn instance is not active (call Carn.start())",already_started:"Carn instance is already started",invalid_depth:"Invalid depth (<0)"},e.Carn=class{constructor(){this.newline="\n",this.indent="  ",this.separator=",",this.dI=0,this.id=1e6*Math.random()|0,this.run=-1,this.s=[],this.ctx=new t(this.id)}start(){return-1==this.ctx.start||this.ctx.finished()?(this.s=[],this.run=1e6*Math.random()|0,this.ctx=new t(this.id),this.ctx.init(this.run)):this.ctx.error("already_started"),this.ctx}add(e){this.ctx.check(),"string"==typeof e&&this.s.push(e)}sep(){this.ctx.check(),this.s.push(new i(this.separator))}depth(e,t){if(this.ctx.check(),"number"==typeof e){let n=(t=null==t||!!t)?this.dI+e:e;n<0&&this.ctx.error("invalid_depth",{move:e,relative:t,depth:n}),this.dI=n,this.s.push(new r(this.dI,this.indent))}return this.dI}finish(){return this.ctx.check(),this.ctx.finish=Date.now(),this.ctx}src(){this.ctx.start<0&&this.ctx.throw("not_active");let e="";for(let t=0;t<this.s.length;t++){let n=t;this.s[n]instanceof r?(e=this.s[n].toString(),this.s[n]=""):(this.s[n+1]instanceof i&&(this.s[n+2]instanceof r||(this.s[n]+=this.s[n+1].toString()),this.s[n+1]="",t++),this.s[n]=e+this.s[n]+this.newline)}return this.s.join("")}inject(e,t,n){let r=this.src();r=r.startsWith("\n")?r:"\n"+r,r=r.endsWith("\n")?r:r+"\n";let i=n[0],o=n[1];const l=new RegExp(i+"START:"+t+o+".*?"+i+"END:"+t+o,"s");return e.replace(l,i+"START:"+t+o+r+i+"END:"+t+o)}};class r{constructor(e,t){this.depth=null==e||e<0?0:e,this.indent=t}toString(){return this.indent.repeat(isNaN(this.depth)?0:this.depth)}}class i{constructor(e){this.separator=e}toString(){return this.separator}}return e}))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),y=y.exports;var m={},b=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m,"__esModule",{value:!0}),m.MarkerMap=m.GeneratorMap=m.GubuGen=void 0;const x=b({}),w={md:["\x3c!--","--\x3e"]};m.MarkerMap=w;const $={"options~md":function(e,t){var n;t.start(),t.add("## Options");let r=[];e(void 0,{err:!1,log:(e,t)=>{if("kv"===e){let e=t.path.slice(1,t.dI+1),n=e.join("."),i=t.node,o=t.key;r.push({path:n,parts:e,node:i,key:o})}}}),r=r.sort((e,t)=>e.path<t.path?-1:e.path>t.path?1:0);let i=1;for(let o of r){let{path:e,parts:r,node:l,key:s}=o,a=l.t,u=l.r,h=l.v,f=(null===(n=l.m)||void 0===n?void 0:n.short)||s,c=r[r.length-1];for(;i<r.length;)t.add(`* _${r[i-1]}_`),t.depth(1),i++;for(;r.length<i;)t.depth(-1),i--;t.add(`* _${c}_: \`${a}\` ${u?"(required)":"(default: "+h+")"} - ${f}`)}}};m.GeneratorMap=$,m.GubuGen=class{constructor(){}generate(e){let t=function(e,t){let n=e.generator,r=e.format,i=$[n+"~"+r];if(null===i){let t=`Cannot find generator ${e.generator} for format ${e.format}`;throw new Error(t)}return i}(e);const n=new y.Carn;t(e.shape,n);let r=(i=e.target,x.default.readFileSync(i).toString());var i;let o=n.inject(r,e.generator,w[e.format]);return function(e,t){x.default.writeFileSync(e,t)}(e.target,o),n}};var I={},k=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(I,"__esModule",{value:!0}),I.JsonicDoc=void 0;const A=k(v);class C{constructor(e,t){this.spec=e;try{const e=require(this.spec.folder);this.plugin=e[this.spec.name],null==this.plugin&&(this.plugin=e[this.spec.name[0].toUpperCase()+this.spec.name.substring(1)]),null==this.plugin&&t.errs.push("No plugin found for name: "+this.spec.name+" in package at: "+this.spec.folder)}catch(n){t.errs.push(n.message)}}genOptionsMD(){const e=this.plugin.defaults,t=(0,g.Gubu)(e),n=A.default.join(this.spec.folder,"README.md");(new m.GubuGen).generate({shape:t,generator:"options",format:"md",target:n})}}return I.JsonicDoc=C,C.defaults={folder:"",name:""},I}));